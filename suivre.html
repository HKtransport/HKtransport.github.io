<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suivi de colis â€“ Baba Colis</title>

<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
    body { margin:0; font-family:'Poppins', sans-serif; background:#f5f5f5; }

    header {
        background:#008000;
        padding:15px;
        text-align:center;
        color:white;
        font-size:22px;
        font-weight:600;
    }

    nav {
        display:flex;
        justify-content:center;
        gap:25px;
        margin-top:10px;
    }

    nav a {
        color:white;
        text-decoration:none;
        font-weight:600;
    }

    nav a:hover { text-decoration:underline; }

    .card {
        background:white;
        padding:20px;
        border-radius:12px;
        box-shadow:0 4px 15px rgba(0,0,0,0.1);
        margin:20px auto;
        max-width:900px;
    }

    input {
        width:100%;
        padding:15px;
        border-radius:10px;
        border:1px solid #ccc;
        margin-top:10px;
        font-size:16px;
    }

    button {
        width:100%;
        padding:15px;
        font-size:18px;
        border:none;
        border-radius:10px;
        background:#008000;
        color:white;
        font-weight:bold;
        cursor:pointer;
        margin-top:15px;
    }

    button:hover { background:#006600; }

    .progress {
        margin-top:20px;
        display:flex;
        justify-content:space-between;
        position:relative;
    }

    .progress::before {
        content:"";
        position:absolute;
        top:50%;
        left:5%;
        width:90%;
        height:4px;
        background:#ddd;
        transform:translateY(-50%);
    }

    .step {
        z-index:2;
        width:22px;
        height:22px;
        background:#ddd;
        border-radius:50%;
        border:3px solid white;
    }

    .step.active { background:#008000; }

    .timeline {
        margin-top:20px;
        border-left:3px solid #008000;
        padding-left:15px;
    }

    .event { margin-bottom:10px; }

    #map {
        height:300px;
        width:100%;
        margin-top:20px;
        border-radius:12px;
    }

    footer {
        background:#004d00;
        color:white;
        padding:20px;
        text-align:center;
        margin-top:40px;
    }
</style>
</head>

<body>

<header>
    Suivi de colis
    <nav>
        <a href="index.html">Accueil</a>
        <a href="suivre.html">Suivre un colis</a>
        <a href="envoyer.html">Envoyer un colis</a>
        <a href="pointsrelais.html">Points relais</a>
        <a href="contact.html">Contact</a>
    </nav>
</header>

<div class="card">
    <h2>Rechercher un colis</h2>

    <input type="text" id="trackingNumber" placeholder="Entrez votre numÃ©ro de suivi (ex : BC-20250211-123456)">
    <button onclick="track()">Rechercher</button>
</div>

<div class="card" id="resultBox" style="display:none;">
    <h2>Informations du colis</h2>

    <p><b>NumÃ©ro :</b> <span id="num"></span></p>
    <p><b>Statut :</b> <span id="status"></span></p>
    <p><b>Localisation :</b> <span id="location"></span></p>

    <div class="progress">
        <div class="step" id="s1"></div>
        <div class="step" id="s2"></div>
        <div class="step" id="s3"></div>
        <div class="step" id="s4"></div>
    </div>

    <h3>Historique</h3>
    <div class="timeline" id="history"></div>

    <h3>Localisation sur la carte</h3>
    <div id="map"></div>
</div>

<footer>
    Â© 2024 Baba Colis â€“ Tous droits rÃ©servÃ©s  
    <br>ðŸ“ž +221 77 000 00 00 â€” âœ‰ contact@hktransport.com
</footer>

<script>
let colis = {};
let map;

// Charger les colis depuis InfinityFree
fetch("https://babacolis.wuaze.com/colis.json")
    .then(res => res.json())
    .then(data => {
        data.forEach(c => colis[c.numero] = c);
    });

function track() {
    const num = document.getElementById("trackingNumber").value.trim().toUpperCase();
    const resultBox = document.getElementById("resultBox");

    if (!colis[num]) {
        alert("NumÃ©ro introuvable");
        return;
    }

    const data = colis[num];

    document.getElementById("num").textContent = num;
    document.getElementById("status").textContent = data.statut;
    document.getElementById("location").textContent = data.localisation;

    for (let i = 1; i <= 4; i++) {
        document.getElementById("s" + i).classList.remove("active");
    }
    for (let i = 1; i <= data.progression; i++) {
        document.getElementById("s" + i).classList.add("active");
    }

    const historyBox = document.getElementById("history");
    historyBox.innerHTML = "";
    data.historique.forEach(event => {
        historyBox.innerHTML += `<div class="event">â€¢ ${event}</div>`;
    });

    if (!map) {
        map = L.map('map').setView(data.coords, 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);
    } else {
        map.setView(data.coords, 10);
    }

    L.marker(data.coords).addTo(map);

    resultBox.style.display = "block";
}
</script>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
